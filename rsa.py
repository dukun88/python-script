import math
from Crypto.Util.number import inverse, long_to_bytes

#ganti N1, c1, e_val, N2

N1 = 15246371575666810318071560882478537680794162003233695143063687779299219917798096533287873061794928043973546967162708047565879160057881329756701227629701058
c1 = 14936627686918967033826024603671491500159795625645685666831649978691027405407167068077266014318526139391629817446892935951972789216938309628528087682212125
e_val = 65537
N2 = 15772710152380393956677230998150838832724202526226220965511426207234192194165075180356723438817864378694883898093570590246925419068885667217116725696190134
p = math.gcd(N1, N2)
if p != 1 and p != N1 and p != N2 and (N1 % p == 0):
    q1 = N1 // p
    if p * q1 == N1: 
        phi1 = (p - 1) * (q1 - 1)
        try:
            d1 = inverse(e_val, phi1)
            decrypted_long = pow(c1, d1, N1)
            flag_bytes = long_to_bytes(decrypted_long)
            actual_flag = flag_bytes.decode('utf-8')
            print(f"FLAG: {actual_flag}")
        except ValueError: 
            pass 
        except Exception: 
            pass